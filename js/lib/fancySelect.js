(function(){var e;e=window.jQuery||window.Zepto||window.$,e.fn.fancySelect=function(n){var s,t;return null==n&&(n={}),t=e.extend({forceiOS:!1,includeBlank:!1,optionTemplate:function(e){return e.text()},triggerTemplate:function(e){return e.text()}},n),s=!!navigator.userAgent.match(/iP(hone|od|ad)/i),this.each(function(){var n,o,r,a,i,l,d;return a=e(this),a.hasClass("fancified")||"SELECT"!==a[0].tagName?void 0:(a.addClass("fancified"),a.css({width:1,height:1,display:"block",position:"absolute",top:0,left:0,opacity:0}),a.wrap('<div class="fancy-select">'),d=a.parent(),a.data("class")&&d.addClass(a.data("class")),d.append('<div class="trigger">'),(!s||t.forceiOS)&&d.append('<ul class="options">'),i=d.find(".trigger"),r=d.find(".options"),o=a.prop("disabled"),o&&d.addClass("disabled"),l=function(){var e;return e=t.triggerTemplate(a.find(":selected")),i.html(e)},a.on("blur.fs",function(){return i.hasClass("open")?setTimeout(function(){return i.trigger("close.fs")},120):void 0}),i.on("close.fs",function(){return i.removeClass("open"),r.removeClass("open")}),i.on("click.fs",function(){var n,l;if(!o)if(i.toggleClass("open"),s&&!t.forceiOS){if(i.hasClass("open"))return a.focus()}else if(i.hasClass("open")&&(l=i.parent(),n=l.offsetParent(),l.offset().top+l.outerHeight()+r.outerHeight()+20>e(window).height()+e(window).scrollTop()?r.addClass("overflowing"):r.removeClass("overflowing")),r.toggleClass("open"),!s)return a.focus()}),a.on("enable",function(){return a.prop("disabled",!1),d.removeClass("disabled"),o=!1,n()}),a.on("disable",function(){return a.prop("disabled",!0),d.addClass("disabled"),o=!0}),a.on("change.fs",function(e){return e.originalEvent&&e.originalEvent.isTrusted?e.stopPropagation():l()}),a.on("keydown",function(e){var n,s,t;if(t=e.which,n=r.find(".hover"),n.removeClass("hover"),r.hasClass("open")){if(38===t?(e.preventDefault(),n.length&&n.index()>0?n.prev().addClass("hover"):r.find("li:last-child").addClass("hover")):40===t?(e.preventDefault(),n.length&&n.index()<r.find("li").length-1?n.next().addClass("hover"):r.find("li:first-child").addClass("hover")):27===t?(e.preventDefault(),i.trigger("click.fs")):13===t||32===t?(e.preventDefault(),n.trigger("mousedown.fs")):9===t&&i.hasClass("open")&&i.trigger("close.fs"),s=r.find(".hover"),s.length)return r.scrollTop(0),r.scrollTop(s.position().top-12)}else if(13===t||32===t||38===t||40===t)return e.preventDefault(),i.trigger("click.fs")}),r.on("mousedown.fs","li",function(n){var t;return t=e(this),a.val(t.data("raw-value")),s||a.trigger("blur.fs").trigger("focus.fs"),r.find(".selected").removeClass("selected"),t.addClass("selected"),i.addClass("selected"),a.val(t.data("raw-value")).trigger("change.fs").trigger("blur.fs").trigger("focus.fs")}),r.on("mouseenter.fs","li",function(){var n,s;return s=e(this),n=r.find(".hover"),n.removeClass("hover"),s.addClass("hover")}),r.on("mouseleave.fs","li",function(){return r.find(".hover").removeClass("hover")}),n=function(){var n;return l(),!s||t.forceiOS?(n=a.find("option"),a.find("option").each(function(n,s){var o;return s=e(s),s.prop("disabled")||!s.val()&&!t.includeBlank?void 0:(o=t.optionTemplate(s),s.prop("selected")?r.append('<li data-raw-value="'+s.val()+'" class="selected">'+o+"</li>"):r.append('<li data-raw-value="'+s.val()+'">'+o+"</li>"))})):void 0},a.on("update.fs",function(){return d.find(".options").empty(),n()}),n())})}}).call(this);